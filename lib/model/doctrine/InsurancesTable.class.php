<?php
/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class InsurancesTable extends DarwinTable
{
  /**
  * Find an insurance value
  * for a given table and record id
  * @param string $table_name db table name
  * @param int $record_id id of the record
  * @return a Doctrine_collection of results
  */
  public function findForTable($table_name, $record_id)
  {
    $q = Doctrine_Query::create()
	 ->from('Insurances i')
         ->leftJoin('i.People p')
	 ->andWhere('i.referenced_relation = ?',$table_name)
         ->andWhere('i.record_id = ?',$record_id)
	 ->orderBy('i.insurance_year DESC');
    return $q->execute();
  }
  /**
  * Get Distincts Currencies
  * @return array an Array of currencies in keys
  */
  public function getDistinctCurrencies()
  {
    $results = Doctrine_Query::create()->
      select('DISTINCT(insurance_currency) as currencies')->
      from('insurances')->
      execute();
    return $results;
  }

}