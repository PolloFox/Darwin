<?php
/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class SpecimenPartsTable extends DarwinTable
{
  /**
  * Get Distincts Buildings of Part
  * @return array an Array of types in keys
  */
  public function getDistinctBuildings()
  {
    return $this->createDistinct('SpecimenParts', 'building', 'buildings')->execute();
  }

  /**
  * Get Distincts Floor of Part
  * @return array an Array of types in keys
  */
  public function getDistinctFloors($building = null)
  {
    $q = $this->createDistinct('SpecimenParts', 'floor', 'floors');
	if(! is_null($building))
	  $q->addWhere('building = ?', $building);
	return $q->execute();
  }

  /**
  * Get Distincts Room of Part
  * @return array an Array of types in keys
  */
  public function getDistinctRooms($building = null, $floor = null)
  {
    $q = $this->createDistinct('SpecimenParts', 'room', 'rooms');
	if(! is_null($building))
	  $q->addWhere('building = ?', $building);

	if(! is_null($floor))
	  $q->addWhere('floor = ?', $floor);

	return $q->execute();
  }

  /**
  * Get Distincts Row of Part
  * @return array an Array of types in keys
  */
  public function getDistinctRows($building = null, $floor = null, $room = null)
  {
    $q = $this->createDistinct('SpecimenParts', 'row', 'rows');
	if(! is_null($building))
	  $q->addWhere('building = ?', $building);

	if(! is_null($floor))
	  $q->addWhere('floor = ?', $floor);

	if(! is_null($room))
	  $q->addWhere('room = ?', $room);

	return $q->execute();
  }

  /**
  * Get Distincts Shelve of Part
  * @return array an Array of types in keys
  */
  public function getDistinctShelfs($building = null, $floor = null, $room = null, $rows = null)
  {
    $q = $this->createDistinct('SpecimenParts', 'shelf', 'shelfs');
	if(! is_null($building))
	  $q->addWhere('building = ?', $building);

	if(! is_null($floor))
	  $q->addWhere('floor = ?', $floor);

	if(! is_null($room))
	  $q->addWhere('room = ?', $room);

	if(! is_null($rows))
	  $q->addWhere('row = ?', $rows);
	return $q->execute();
  }

  /**
  * Get Distincts Container of Part
  * @return array an Array of types in keys
  */
  public function getDistinctContainerTypes()
  {
    $contTypes = $this->createDistinct('SpecimenParts', 'container_type', 'container_type')->execute();
    $contTypes->add(new SpecimenParts);
    return $contTypes;
  }

  /**
  * Get Distincts Sub Container of Part
  * @return array an Array of types in keys
  */
  public function getDistinctSubContainerTypes()
  {
    $subContTypes = $this->createDistinct('SpecimenParts', 'sub_container_type', 'sub_container_type')->execute();
    $subContTypes->add(new SpecimenParts);
    return $subContTypes;
  }

  /**
  * Get Distincts Sub Container of Part
  * @return array an Array of types in keys
  */
  public function getDistinctParts()
  {
    $parts = $this->createDistinct('SpecimenParts', 'specimen_part', 'specimen_part')->execute();
    $parts->add(new SpecimenParts);
    return $parts;
  }

  /**
  * Get Distincts status of Part
  * @return array an Array of types in keys
  */
  public function getDistinctStatus()
  {
    $statuses = $this->createDistinct('SpecimenParts', 'specimen_status', 'specimen_status')->execute();
    $statuses->add(new SpecimenParts);
    return $statuses;
  }

  /**
  * Get Distincts Container Storages of Part
  * filter by type if one given
  * @param string $type a type
  * @return array an Array of types in keys
  */
  public function getDistinctContainerStorages($type)
  {
    $q = $this->createDistinct('SpecimenParts INDEXBY storage', 'container_storage', 'container_storage','');
    if(! is_null($type))
      $q->addWhere('container_type = ?', $type);
    $results = $q->fetchArray();
    if(count($results))
      $results = array_combine(array_keys($results),array_keys($results));

    return array_merge(array('dry'=>'dry'), $results);
  }

  /**
  * Get Distincts Sub Container Storages of Part
  * filter by type if one given
  * @param string $type a type
  * @return array an Array of types in keys
  */
  public function getDistinctSubContainerStorages($type)
  {
	$q = $this->createDistinct('SpecimenParts INDEXBY storage', 'sub_container_storage', 'sub_container_storage','');
	if(! is_null($type))
	  $q->addWhere('container_type = ?', $type);

	$results = $q->fetchArray();
    if(count($results))
      $results = array_combine(array_keys($results),array_keys($results));

    return array_merge(array('dry'=>'dry'), $results);
  }

  /**
  * Get all parts for an individual with some details info
  * @param int $individual Id of the individual
  * @return Doctrine_Collection of parts
  */
  public function findForIndividual($individual)
  {
	$q = Doctrine_Query::create()
		  ->from('SpecimenParts p')
		  ->andWhere('p.specimen_individual_ref = ?',$individual)
		  ->orderBy('p.specimen_part ASC, p.room ASC, p.row ASC, p.shelf ASC');
	return $q->execute();
  }

}