<?php

/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class UsersTracking extends BaseUsersTracking
{
  public function getLink()
  {
	$id = $this->_get('record_id');
	$link = '';
	switch($this->_get('referenced_relation'))
	{
	  case 'collections':
		  $link = 'collection/edit?id='.$id; break;
	  case 'specimens':
		  $link = 'specimen/edit?id='.$id; break;
	  case 'comments':
		  break;
	  case 'tag_groups':
		  break;
	  case 'taxonomy':
	  case 'lithology':
	  case 'chronostratigraphy':
	  case 'mineralogy':
	  case 'people':
	  case 'insurances':
	  case 'specimen_individuals':
	  case 'specimen_parts':
	  case 'gtu':
	  default:
	      $link = $this->_get('referenced_relation').'/edit?id='.$id; break;
	}
	return $link;
  }
  
  public function getDiffAsArray($is_old = true)
  {
    if($is_old)
      $hstore = $this->_get('old_diff');
    else
      $hstore = $this->_get('new_diff');
    eval("\$diff = array({$hstore});");
    foreach($diff as $key=>$value)
    {
      if(preg_match("/_indexed$/", $key) || preg_match("/_name_ts$/", $key) || preg_match("/_order_by$/", $key))
	unset($diff[$key]);
    }
    return $diff;
  }
}

